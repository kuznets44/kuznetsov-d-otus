Реализация ДЗ на CustomElement с ShadowDOM.
Для проверки работы коллбэков добавил дополнительно возможность закрытия/окрытия поддерева по клику.
При этом используется атрибут closed, котоый устанавливается в список отслеживаемых, и при его изменении меняется css-класс детей дерева

запуск: npm start, работает по адресу http://localhost:8000