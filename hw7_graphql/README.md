Домашняя работа для `Занятия "GraphQL Server"`
---

Часть 1.
Написать схему GraphQL для примера веб-приложения e-commerce shop:
до 3 балла - какие сущности (минимум 3, можно больше), какие у них поля, какие обязательные какие нет
до 4 баллов - какие запросы/мутации понадобятся (минимум 4, можно больше)

Часть 2.
до 5 баллов - развернуть локально graphQL + nodejs или воспользоваться одним из веб демо (graphqlbin), перенести полностью или частично написанную в Части 1 схему.
Результатом работы будет ссылка на онлайн демо или репозиторий.

--------------------------------------------------------------------

Порядок решения.

0. Для упрощения решения примем следующие допущения:
- каталог будет содержать одноуровневую структуру категорий
- товар может входить только в одну категорию
- наполнять корзину и делать заказы может только зарегистрированный пользователь
- приложение будет отдавать данные для следующего набора страниц, минимально необходимых для функционирования приложения e-commerce
  - страница категорий (структура каталога) - список категорий с названиями и урлами
  - страница одной категории - перечень товаров с урлами, для товара показываем артикул, название, картинки и цену
  - страница товара - вся информация о товаре (артикул, картинки, описание, цена)
  - страница корзины пользователя - перечень товаров, добавленных в корзину (артикул, название, цена, одна картинка, количество)
- помимо этого приложение будет реализовывать следующий минимально необходимый функционал:
  - добавление товара (как пример мутации, для остальных сущностей в рамках задачи выполнять не будем) 
  - удаление товара (как пример мутации, для остальных сущностей в рамках задачи выполнять не будем)
  - добавление товаров в корзину
  - оформление заказа

1. Проектируем данные

categories - Категории товаров
  code: String! - будет выполнять роль уникального идентификатора и являться частью URL категории
  name: String!


products - Товары
  sku: String!  - артикул. Будет выполнять роль уникального идентификатора и являться частью URL товара
  name: String!
  pictures: [String]
  category: String! - код категории
  price: Int

users - пользователи
  email: String!  - будет выполнять роль уникального идентификатора
  firstName: String!
  lastName: String

carts - корзины
  user: String! - email пользователя
  products: [{  - товары. Здесь для упрощения выборок имеет смысл частично встроить данные о товаре (артикул, название и картинку), необходимые для показа
      sku: String,
      name: String!
      picture: String!
      price:Int!
      quantity: Int!
  }]

orders - заказы
  number: Integer,
  createdAt: Date,
  user: { - встроим данные пользователя для упрощения выборок
    email:String!
    firstName: String!
    lastName: String
  },
  products: [{ - частично встроим данные о товаре аналогично корзине (для быстрой выборке напр. при отправке писем или показа заказа в истории)
      sku: String,
      name: String!
      picture: String!
      price:Integer!
      quantity: Integer!
  }]
  delivery: {
    service: ENUM(sdek,self-delivery,courier),
    price:Float!
    address: String
  }
  status: ENUM(New, Confirmed, Payed, Fulfilled, Cancelled)

2. Для более реалистичной среды работы приложения создаем базу данных MongoDB (здесь используется бесплатный аккаунт Atlas)
3. Создаем каркас приложения express с предварительным соединением с БД (пакет mongodb)
4. Описываем схему данных в терминах GraphQL и подключаем схему к приложению при помощи пакета express-graphql
5. Для каждого запроса реализуем функции-резолверы
6. Проверяем работу приложения на след. запросах через оболочку GraphIQL http://localhost:3000/graphql
- получить данные о структуре каталога
  query {
    categories {
      name
      code
      url
    }
  }
- получить данные о категории
  query {
    category(code:"chairs") {
      code
      name
      url
      products {
        name
        sku
        url
        pictures
        price
      }
    }
  }

- получить данные о товаре
  query {
    product(sku:"C001") {
      sku
      name
      url
      pictures
      price
      description
    }
  }

- добавить товар
  mutation{
    createProduct(sku:"C002",name:"Стул",category:"chairs",description:"Test desc",price: 1000) {
      name
      sku
    }
  }
- удалить товар
  mutation {
    deleteProduct(sku:"C002")
  }
- добавить 2 товара в корзину пользователя
  mutation {
    addToCart(user:"test@test.ru",products:[
      {sku:"C001",quantity:2},
      {sku:"T001",quantity:1}
    ]) {
      user
      products {
        sku
        name
        price
        picture
        quantity
      }
    }
  }
- оформить заказ
  mutation {
    checkout(
      user:"test@test.ru",delivery:{
        service:ems,
        price:300,
        address:"test"
      } 
    )	{
      user {
        email
        firstName
      }
      products {
        sku
        name
        price
        quantity
      }
      delivery {
        service
        price
        address
      }
    } 
  }